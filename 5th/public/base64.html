<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <form action="/upload/excel" method="post" enctype="multipart/form-data">
      상품번호: <input type="text" name="product_id" value="100" /><br />
      이미지 타입: <input type="text" name="image_type" value="1" /><br />
      <input type="file" name="images" accept=".jpg, .jpeg, .png" /><br />
      <button type="submit">버튼</button>
    </form>

    <script>
      document
        .querySelector('input[type="file"]')
        .addEventListener('change', function (e) {
          const file = e.target.files[0];
          const pid = document.querySelector('input[name="product_id"]').value;
          const ptype = document.querySelector(
            'input[name="image_type"]'
          ).value;
          const reader = new FileReader();
          reader.onload = function (e) {
            console.log(e.target.result);
            fetch(`upload/${pid}/${ptype}/${file.name}`, {
              method: 'post',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ imageBase64: e.target.result }),
            })
              .then((response) => response.text())
              .then((data) => {
                console.log(data);
              })
              .catch((err) => {
                console.log(err);
              });
          };
          reader.readAsDataURL(file);
        });
    </script>
  </body>
</html>
